<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>深入理解javascript原型和闭包—【闭包一】 | 大前端宝典</title>
    <meta name="generator" content="VuePress 1.5.4">
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <meta name="description" content="每天至少一个问题，有关前端，后端，graphql，devops，微服务以及软技能，促进个人职业成长，敲开大厂之门。">
    <link rel="preload" href="/assets/css/0.styles.49f7e903.css" as="style"><link rel="preload" href="/assets/js/app.8798bf52.js" as="script"><link rel="preload" href="/assets/js/2.309d842d.js" as="script"><link rel="preload" href="/assets/js/11.68a71fb5.js" as="script"><link rel="prefetch" href="/assets/js/10.3c87c56f.js"><link rel="prefetch" href="/assets/js/12.ae4cb11c.js"><link rel="prefetch" href="/assets/js/13.973b8910.js"><link rel="prefetch" href="/assets/js/14.f0617c0d.js"><link rel="prefetch" href="/assets/js/15.76606388.js"><link rel="prefetch" href="/assets/js/16.5283538a.js"><link rel="prefetch" href="/assets/js/17.406efa57.js"><link rel="prefetch" href="/assets/js/18.4ba83be1.js"><link rel="prefetch" href="/assets/js/19.a8b0bf97.js"><link rel="prefetch" href="/assets/js/20.6e63fae1.js"><link rel="prefetch" href="/assets/js/21.1dd47ea9.js"><link rel="prefetch" href="/assets/js/22.6bcf0540.js"><link rel="prefetch" href="/assets/js/23.3484870e.js"><link rel="prefetch" href="/assets/js/24.6cf1aed4.js"><link rel="prefetch" href="/assets/js/25.cbe880a4.js"><link rel="prefetch" href="/assets/js/26.9b43c128.js"><link rel="prefetch" href="/assets/js/27.9d7643d5.js"><link rel="prefetch" href="/assets/js/28.141ef07a.js"><link rel="prefetch" href="/assets/js/29.b5e89cdc.js"><link rel="prefetch" href="/assets/js/3.ef859757.js"><link rel="prefetch" href="/assets/js/30.82eba3bc.js"><link rel="prefetch" href="/assets/js/31.adfa0a77.js"><link rel="prefetch" href="/assets/js/32.f1e5c90f.js"><link rel="prefetch" href="/assets/js/33.e2b8c944.js"><link rel="prefetch" href="/assets/js/34.83770c85.js"><link rel="prefetch" href="/assets/js/35.8e4926de.js"><link rel="prefetch" href="/assets/js/36.0a740388.js"><link rel="prefetch" href="/assets/js/37.b3475a62.js"><link rel="prefetch" href="/assets/js/38.5db03092.js"><link rel="prefetch" href="/assets/js/39.28eb170e.js"><link rel="prefetch" href="/assets/js/4.57acf39a.js"><link rel="prefetch" href="/assets/js/40.33a385cf.js"><link rel="prefetch" href="/assets/js/41.f5a9f6af.js"><link rel="prefetch" href="/assets/js/42.76a55904.js"><link rel="prefetch" href="/assets/js/43.77c5035b.js"><link rel="prefetch" href="/assets/js/44.52c8afcf.js"><link rel="prefetch" href="/assets/js/45.6a8a58ae.js"><link rel="prefetch" href="/assets/js/46.2fdc129d.js"><link rel="prefetch" href="/assets/js/47.fd34e7f6.js"><link rel="prefetch" href="/assets/js/48.e373fbdf.js"><link rel="prefetch" href="/assets/js/49.b231f050.js"><link rel="prefetch" href="/assets/js/5.ed301b0f.js"><link rel="prefetch" href="/assets/js/50.52ed4176.js"><link rel="prefetch" href="/assets/js/51.14349411.js"><link rel="prefetch" href="/assets/js/52.92f59d36.js"><link rel="prefetch" href="/assets/js/53.a028abae.js"><link rel="prefetch" href="/assets/js/54.709613a3.js"><link rel="prefetch" href="/assets/js/55.8e0ac6cb.js"><link rel="prefetch" href="/assets/js/56.78719ada.js"><link rel="prefetch" href="/assets/js/57.66241bf9.js"><link rel="prefetch" href="/assets/js/58.87e805cf.js"><link rel="prefetch" href="/assets/js/59.b5817bc8.js"><link rel="prefetch" href="/assets/js/6.508e8cfe.js"><link rel="prefetch" href="/assets/js/60.dcb48517.js"><link rel="prefetch" href="/assets/js/61.0ec2bc3f.js"><link rel="prefetch" href="/assets/js/62.243e9173.js"><link rel="prefetch" href="/assets/js/63.1e6b57f6.js"><link rel="prefetch" href="/assets/js/64.686e190f.js"><link rel="prefetch" href="/assets/js/65.dcfa0c9c.js"><link rel="prefetch" href="/assets/js/66.7c4c8c52.js"><link rel="prefetch" href="/assets/js/67.ab561920.js"><link rel="prefetch" href="/assets/js/7.68a44e2e.js"><link rel="prefetch" href="/assets/js/8.604f05e5.js"><link rel="prefetch" href="/assets/js/9.e5672357.js">
    <link rel="stylesheet" href="/assets/css/0.styles.49f7e903.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">大前端宝典</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/house/" class="nav-link">
  house
</a></div><div class="nav-item"><a href="/front/" class="nav-link router-link-active">
  大前端
</a></div><div class="nav-item"><a href="/backend/" class="nav-link">
  后端
</a></div><div class="nav-item"><a href="/algorithm/" class="nav-link">
  数据结构与算法
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/house/" class="nav-link">
  house
</a></div><div class="nav-item"><a href="/front/" class="nav-link router-link-active">
  大前端
</a></div><div class="nav-item"><a href="/backend/" class="nav-link">
  后端
</a></div><div class="nav-item"><a href="/algorithm/" class="nav-link">
  数据结构与算法
</a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/front/" aria-current="page" class="sidebar-link">目录</a></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>css3</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>js</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/front/js/" aria-current="page" class="sidebar-link">目录</a></li><li><a href="/front/js/1.html" class="sidebar-link">in 运算符和 Object.hasOwnProperty 方法有什么区别？⭐️</a></li><li><a href="/front/js/3.html" class="sidebar-link">什么是事件传播？⭐️</a></li><li><a href="/front/js/4.html" class="sidebar-link">深入理解javascript原型和闭包之[一切都是对象]⭐️</a></li><li><a href="/front/js/5.html" class="sidebar-link">深入理解javascript原型和闭包之[函数和对象的关系]⭐️</a></li><li><a href="/front/js/6.html" class="sidebar-link">深入理解javascript原型和闭包之[prototype原型]⭐️</a></li><li><a href="/front/js/7.html" class="sidebar-link">深入理解javascript原型和闭包之[隐式原型]⭐️</a></li><li><a href="/front/js/8.html" class="sidebar-link">深入理解javascript原型和闭包之[instanceof]</a></li><li><a href="/front/js/9.html" class="sidebar-link">深入理解javascript原型和闭包之[继承]⭐️</a></li><li><a href="/front/js/10.html" class="sidebar-link">深入理解javascript原型和闭包之[简述执行上下文-上]⭐️</a></li><li><a href="/front/js/11.html" class="sidebar-link">深入理解javascript原型和闭包之[简述执行上下文-下]⭐️</a></li><li><a href="/front/js/12.html" class="sidebar-link">深入理解javascript原型和闭包之[this]⭐️</a></li><li><a href="/front/js/13.html" class="sidebar-link">深入理解javascript原型和闭包之[执行上下文栈]⭐️</a></li><li><a href="/front/js/14.html" class="sidebar-link">深入理解javascript原型和闭包之[简介--作用域]⭐️</a></li><li><a href="/front/js/15.html" class="sidebar-link">深入理解javascript原型和闭包之[作用域和执行上下文环境]⭐️</a></li><li><a href="/front/js/16.html" class="sidebar-link">深入理解javascript原型和闭包之[从自由变量到作用域链]⭐️</a></li><li><a href="/front/js/17.html" aria-current="page" class="active sidebar-link">深入理解javascript原型和闭包之[闭包一]⭐️</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/front/js/18.html" class="sidebar-link">深入理解javascript原型和闭包之[闭包二]⭐️</a></li><li><a href="/front/js/19.html" class="sidebar-link">防抖和节流原理分析--防抖⭐️</a></li><li><a href="/front/js/20.html" class="sidebar-link">防抖和节流原理分析--节流⭐️</a></li><li><a href="/front/js/21.html" class="sidebar-link">Promise里的代码为什么比setTimeout先执行？⭐️</a></li><li><a href="/front/js/22.html" class="sidebar-link">如何写出一个惊艳面试官的深拷贝？⭐️</a></li><li><a href="/front/js/23.html" class="sidebar-link">javascript设计模式之单例模式 ⭐️</a></li><li><a href="/front/js/24.html" class="sidebar-link">javascript设计模式之构造函数模式 ⭐️</a></li><li><a href="/front/js/25.html" class="sidebar-link">javascript设计模式之建造者模式 ⭐️</a></li><li><a href="/front/js/26.html" class="sidebar-link">javascript设计模式之工厂模式 ⭐️</a></li><li><a href="/front/js/27.html" class="sidebar-link">javascript设计模式之装饰者模式 ⭐</a></li><li><a href="/front/js/28.html" class="sidebar-link">javascript设计模式之外观模式 ⭐</a></li><li><a href="/front/js/48.html" class="sidebar-link">javascript的new操作都做了什么？⭐️</a></li><li><a href="/front/js/49.html" class="sidebar-link">JavaScript可视化：Promise和Async/Await？⭐️</a></li><li><a href="/front/js/50.html" class="sidebar-link">javascript中Proxy和defineProperty对比 ⭐️</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>vue</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>element</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h3 id="深入理解javascript原型和闭包-【闭包一】"><a href="#深入理解javascript原型和闭包-【闭包一】" class="header-anchor">#</a> 深入理解javascript原型和闭包—【闭包一】</h3> <p>前面提到的上下文环境和作用域的知识，除了了解这些知识之外，还是理解闭包的基础。</p> <p>至于&quot;闭包&quot;这个词的概念的文字描述，确定不好解释，我看过很多遍，但是现在还是记不住。</p> <p><strong>但是你只需要知道应用的两种情况即可--函数作为返回值，函数作为参数传递。</strong></p> <p><strong>第一，函数作为返回值</strong></p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> max <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
    
    <span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token function">bar</span><span class="token punctuation">(</span><span class="token parameter">x</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>x <span class="token operator">&gt;</span> max<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> f1 <span class="token operator">=</span> <span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">f1</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>如上代码，bar函数作为返回值，赋值给f1变量。执行f1(15)时，用到了fn作用域下的max变量的值。至于如何跨作用域，可以参考上一节。</p> <p><strong>第二，函数作为参数被传递</strong></p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> max <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">,</span>
	<span class="token function-variable function">fn</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">x</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>x <span class="token operator">&gt;</span> max<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
	<span class="token punctuation">}</span><span class="token punctuation">;</span>
	
<span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">f</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> max <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">;</span>
    <span class="token function">f</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span>fn<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>如上代码中，fn函数作为一个参数被传递进入另一个函数，赋值给f参数。执行f(15)时，max变量的取值是10，而不是100。</p> <p>上一节讲到自由变量跨作用域取值时，曾经强调过：**要去创建这个函数的作用域取值，而不是“父作用域”。**理解了这一点，以上代码中，自由变量如何取值应该比较简单。（不明白的朋友一定要去上一节看看，这个很重要！）</p> <p>另外，讲到闭包，除了结合着作用域之外，还需要结合着执行上下文栈来说一下。</p> <p>在前面讲执行上下文栈时[深入理解javascript原型和闭包之[执行上下文栈] ][13.html]，我们提到当一个函数被调用完成之后，其执行上下文环境将被销毁，其中的变量也会被同时销毁。</p> <p>但是在当时那篇文章中留了一个问号——有些情况下，函数调用完成之后，其执行上下文环境不会接着被销毁。这就是需要理解闭包的核心内容。</p> <p>咱们可以拿本文的第一段代码（稍作修改）来分析一下。</p> <p><img src="data:image/png;base64,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" alt="16f879b5b51541a1"></p> <p>第一步，代码执行前生成全局上下文环境，并在执行时对其中的变量进行赋值。此时全局上下文环境是活动状态。</p> <p><img src="/assets/img/260749349988764.f69e45f2.png" alt="16f879b5b51541a1"></p> <p>第二步，执行第17行代码时，调用fn()，产生fn()执行上下文环境，压栈，并设置为活动状态。</p> <p><img src="/assets/img/260750319351092.151e0b23.png" alt="16f879b5b51541a1"></p> <p>第三步，执行完第17行，fn()调用完成。按理说应该销毁掉fn()的执行上下文环境，但是这里不能这么做。注意，重点来了：因为执行fn()时，<strong>返回的是一个函数。函数的特别之处在于可以创建一个独立的作用域。</strong></p> <p>而正巧合的是，返回的这个函数体中，还有一个自由变量max要引用fn作用域下的fn()上下文环境中的max。因此，这个max不能被销毁，销毁了之后bar函数中的max就找不到值了。</p> <p>因此，这里的fn()上下文环境不能被销毁，还依然存在与执行上下文栈中。</p> <p>——即，执行到第18行时，全局上下文环境将变为活动状态，但是fn()上下文环境依然会在执行上下文栈中。另外，执行完第18行，全局上下文环境中的max被赋值为100。如下图：</p> <p><img src="/assets/img/260957500455644.cc9a79eb.png" alt="16f879b5b51541a1"></p> <p>第四步，执行到第20行，执行f1(15)，即执行bar(15)，创建bar(15)上下文环境，并将其设置为活动状态。</p> <p><img src="/assets/img/260958057327369.05452063.png" alt="16f879b5b51541a1"></p> <p>执行bar(15)时，max是自由变量，需要向创建bar函数的作用域中查找，找到了max的值为10。这个过程在作用域链一节已经讲过。</p> <p>这里的重点就在于，创建bar函数是在执行fn()时创建的。fn()早就执行结束了，但是fn()执行上下文环境还存在栈中，因此bar(15)时，max可以查找到。如果fn()上下文环境销毁了，那么max就找不到了。</p> <p><strong>使用闭包会增加内容开销，现在很明显了吧！</strong></p> <p>第五步，执行完20行就是上下文环境的销毁过程，这里就不再赘述了。</p> <p>闭包和作用域、上下文环境有着密不可分的关系，真的是&quot;想说爱你不容易&quot;！</p> <p>另外，闭包在jQuery中的应用非常多，在这里就不一一举例子了。所以，无论你是想了解一个经典的框架/类库，还是想自己开发一个插件或者类库，<strong>像闭包、原型这些基本的理论，是一定要知道的。否则，到时候出了BUG你都不知道为什么</strong>，因为这些BUG可能完全在你的知识范围之外。</p> <p>到现在闭包就简单介绍完了，下节深入扩充一下对闭包的相关知识</p></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">2/23/2021, 1:02:48 AM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/front/js/16.html" class="prev">
        深入理解javascript原型和闭包之[从自由变量到作用域链]⭐️
      </a></span> <span class="next"><a href="/front/js/18.html">
        深入理解javascript原型和闭包之[闭包二]⭐️
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.8798bf52.js" defer></script><script src="/assets/js/2.309d842d.js" defer></script><script src="/assets/js/11.68a71fb5.js" defer></script>
  </body>
</html>
